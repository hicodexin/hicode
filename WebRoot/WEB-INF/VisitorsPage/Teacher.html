<!DOCTYPE html>
<html>
  <head>
    <title>Teacher.html</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8">
    
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
	<style type="text/css">
		*{
			margin: 0px;
			padding: 0px;
		}
		#hidd_mask{
			background-color: #D0D0D0;
			opacity: 0.5;
			width:100%;
			position: absolute;
			z-index: 6;
		}
		
	</style>
	<link type="text/css" rel="stylesheet"  href="/hicode/syscss/teacher_page.css" />
	<link type="text/css" rel="stylesheet"  href="/hicode/syscss/for_date.css" />
	<script type="text/javascript" src="/hicode/sysjs/jquery.min.js"></script>
	<script type="text/javascript" src="/hicode/sysjs/forfunctions.js"></script>
	<script type="text/javascript" src="/hicode/sysjs/jeDate.js"></script>
  </head>
  
  <body>
  		<!-- 隐藏  -->
  	  	<div id="hidd_mask"></div>
 	  	<div id="dv_update">
	  		<div class="dv_title" id="dv_title">修改讲师信息</div>
	  		<div class="dv_upmain">
	  			<ul class="up_ul">
		  			<li>
		  				<b>序号 : </b>
		  				<input type="text" id="tea_list" value=""  disabled="disabled"/>
		  			</li>
		  			<li>
		  				<b>教师姓名 : </b>
		  				<input type="text" id="userName"/>
		  			</li>
		  			<li>
		  				<b>教师性别 : </b>
		  				<label for="sex_b">
		  					<img src="/hicode/sysimg/face_boy.jpg" />
		  					<input type="radio" id="sex_b" name="t_sex"  value="1" checked="checked"/>
		  				</label>
		  				<label for="sex_g">
		  					<img src="/hicode/sysimg/face_girl.jpg" />
		  					<input type="radio" id="sex_g" name="t_sex" value="0" />
		  				</label>
		  			</li>
		  			<li>
		  				<b>是否在职 : </b>
		  				<label for="job_b">
		  					<img src="/hicode/sysimg/face_smile.jpg" />
		  					<input type="radio" id="job_b" name="if_Onthejob"  value="1" checked="checked"/>
		  				</label>
		  				<label for="job_g">
		  					<img src="/hicode/sysimg/face_grieved.jpg" />
		  					<input type="radio" id="job_g" name="if_Onthejob" value="0" />
		  				</label>
		  			</li>
		  			<li>
		  				<b>入职时间 : </b>
		  				<input id="time_creatDate" type="text" disabled="disabled" readonly>
		  			</li>
		  			<li>
		  				<b>离职时间 : </b>
		  				<input class="datainp" id="time_endDate" type="text" placeholder="请选择" readonly>
		  			</li>
		  			<li>
		  				<b>当前职称 : </b>
		  				<select id="update_sel">
		  					<option>讲师助教</option>
		  					<option>初级讲师</option>
		  					<option>中级讲师</option>
		  					<option>高级讲师</option>
		  					<option>教学总监</option>
		  				</select>
		  			</li>
		  			<li>
		  				<b>晋级时间 : </b>
		  				<input class="datainp" id="title_updatetime" type="text" placeholder="请选择"  readonly>
		  			</li>
		  		</ul>
	  		</div>
	  		<div id="dv_upbottom">
	  			<button id="up_sub">提交</button>
				<button id="up_res">返回</button>
	  		</div>
  	</div>
  	  	
  	<div class="dv_top">
		<button id="index_go">首页</button>
	</div>
    <hr>
    <div class="dv_title">讲师信息详情</div>
    <button id="bt_1">添加</button>
    <div id="dv_table">
	    <table id="tea_tbl"  cellspacing="0">
	    	<thead> 
	    		<tr>
	    			<th>序号</th>
	    			<th>教师姓名</th>
	    			<th>教师性别</th>
	    			<th>是否在职</th>
	    			<th>入职时间</th>
	    			<th>离职时间</th>
	    			<th>当前职称</th>
	    			<th>晋级时间</th>
	    			<th>操作</th>
	    			<th>标记</th>
	    		</tr>
	    	</thead>
	    	<tbody id="tbl_body">
	    	</tbody>
	    </table>
    </div>
    <div id="dv_page">
		<button id="bt_first" mypage="1">首页</button>
		<div id="dv_but"></div>
		<button id="bt_end">尾页</button>
	</div>
  </body>
  <script type="text/javascript">
  	$().ready(function(){
  	
  		var bd_hig = document.documentElement.clientHeight;
  		$("#hidd_mask").css("height",bd_hig+"px");
  		$("#dv_update").hide();
  		$("#hidd_mask").hide();
  		start_post();
  		//第一页
 		$("#bt_first").click(function(){
 			change_page(this);
 			$("#dv_but button:eq(0)").css({"backgroundColor":"#336699","color":"#fff"});
 		});
 		
 		//最后一页
 		$("#bt_end").click(function(){
 			change_page(this);
 			$("#dv_but button:eq(-1)").css({"backgroundColor":"#336699","color":"#fff"});
 		});
  		
  		$("#index_go").click(function(){
 			window.location = "/hicode/index.html";
 		});
 		
 		
		for_btn();
  		
  		// 点击返回消失
  		$("#up_res").click(function(){
  			$("#hidd_mask").hide().hide(300);
 			$("#dv_update").show().hide(300);
 		});
 		//点击添加按钮
 		$("#bt_1").click(function(){
 			$("#hidd_mask").hide().show(300);
 			$("#dv_update").hide().show(300);
 			$("#dv_title").html("添加讲师信息");
 			$("#up_sub").html("添加");
 			var len = $("#tea_tbl tbody tr").length;
			$("#tea_list").val(len+1);
			$("#userName").val("");
			$("#time_creatDate").val("");
			$("#time_endDate").val("");
			$("#title_updatetime").val("");
			$("#time_creatDate").removeAttr("disabled");
 		});
  		
  		$("#up_sub").click(function(){
  			if($("#userName").val().trim().length<2){
 				$("#userName").css("borderColor","#f00");
 				return;
 			}else{
 				$("#userName").css("borderColor","#336699");
 			}
 			
 			if($("#time_creatDate").val().length < 10){
 				$("#time_creatDate").css("borderColor","#f00");
 				return;
 			}else{
 				$("#time_creatDate").css("borderColor","#336699");
 			}
  			var data = {};
  			
  			data = {
				 			"userName":$("#userName").val().trim(),
				 			"sex":$('input:radio[name="t_sex"]:checked').val(),
				 			"title":$("#update_sel").val(),
				 			"if_Onthejob":$('input:radio[name="if_Onthejob"]:checked').val(),
				 			"time_creatDate":$("#time_creatDate").val(),
				 			"time_endDate":$("#time_endDate").val(),
				 			"title_updatetime":$("#title_updatetime").val()
	 			};
	 			
  			var content = $(this).html();
  			if(content=="添加"){
	 		 	$.post("/hicode/teacher/do_insertTeacher.spc",data,function(e){
	 				$("#hidd_mask").hide().hide(300);
	 				$("#dv_update").show().hide(300);
	 				if(e.list_advs == 'ok'){
	 					alert("添加成功");
	 					$("#tbl_body").children("tr").remove();
	 					start_post();
	 					for_btn();
	 				}else{
	 					alert("添加失败,请联系管理员。。。。");
	 				}
	 			
	 			},"json");
  			}
  			if(content=="修改"){
  				if($("#time_endDate").val().length > 3){
	 				$("#time_endDate").css("borderColor","#f00");
	 				 if(!window.confirm("此人确定离职？？？？")){
	 					 return;
	 				 }
	 			}
	 			
	 			if(!window.confirm("是否确定要修改的内容？？？？")){
	 				return;
	 			}
  				data.id =$("#tea_list").attr("name");
  				
	 			$.post("/hicode/teacher/do_updateTeacher.spc",data,function(e){
	 				$("#hidd_mask").hide().hide(300);
	 				$("#dv_update").show().hide(300);
	 				if(e.list_advs == 'ok'){
	 					alert("修改成功");
	 					$("#tbl_body").children("tr").remove();
	 					start_post();
	 					for_btn();
	 				}else{
	 					alert("添加失败,请联系管理员。。。。");
	 				}
	 			
	 			},"json");
	 			
	 			
  			}
  		});
  		
  		function start_post(){
  			
			$.post("/hicode/teacher/showTeacherByInfo.spc",{ "page" : 1 },function(a){
				if(a){
					creat_tbTea(a.list_tea,"#tbl_body");
					/* 添加页码 */
					if(a.all_num){
						$("#dv_but").children("button").remove();
						for(var k=0;k<a.all_num;k++){
							var btn = document.createElement("button");
							$(btn).html(k+1);
							$(btn).attr("mypage",(k+1));
							if(k==0){
								$(btn).css({"backgroundColor":"#336699","color":"#fff"});
							}
							$(btn).click(function(){
								change_page(this);
							});
							
							$("#dv_but").append(btn);
						}
						$("#bt_end").attr("mypage",a.all_num);
					}
					
				}
				var hei = $("#tea_tbl").css("height");
				hei = hei.substr(0,hei.length-2 );
	 			if(hei>650){
	 				$("#dv_table").css("height","800px");
	 			}
			
			},"json");
  		}
  		
  		/* 切换页码 */
 		function change_page(this_dom){
			$("#dv_but button").css({"backgroundColor":"#fff","color":"#336699"});
			$(this_dom).css({"backgroundColor":"#336699","color":"#fff"});
			
			$.post("/hicode/teacher/showTeacherByInfo.spc",{"page":$(this_dom).attr("mypage")},function(a_s){
				$("#tbl_body").html(' ');
				
				var js_arry = eval('(' + a_s + ')');
				
				creat_tbTea(js_arry.list_tea,"#tbl_body");
				for_btn();
			});
		}
		
		/* 修改按钮 */
		function for_btn() {
			window.setTimeout(function() {
				var bts = $("button");
				var revise = new Array();
				if (bts.length > 0) {
					for (var i = 0, j = 0; i < bts.length; i++) {
						if ($(bts[i]).html() == "修改") {
							revise[j] = bts[i];
							j++;
						}
					}
				}
				
				console.log("================");
				console.log(revise);
				if (revise.length > 0) {
					for (var k = 0; k < revise.length; k++) {
						(function() {
							var t = k;
							$(revise[t]).click(function() {
								$("#hidd_mask").hide().show(300);
								$("#dv_update").hide().show(300);
								$("#dv_title").html("修改讲师信息");
								$("#tea_list").val($(this).attr("name"));
								$("#tea_list").attr("name", $(this).attr("id"));
								$("#userName").val($("[name='userName']:eq(" + t + ")").html());
								$("#time_creatDate").val($("[name='creatDate']:eq(" + t + ")").html());
								$("#time_endDate").val($("[name='endDate']:eq(" + t + ")").html());
								if($("#time_endDate").val() == '' || $("#time_endDate").val() == null){
									$("#time_endDate").removeAttr("disabled");
									$("#title_updatetime").removeAttr("disabled");
								}else{
									$("#time_endDate").attr("disabled","disabled");
									$("#title_updatetime").attr("disabled","disabled");
								}
								$("#title_updatetime").val($("[name='updatetime']:eq(" + t + ")").html());
								$("#up_sub").html("修改");
							});

						})();

					}
				}

			}, 500);
		}
		
		// 日历插件
		jeDate({
			dateCell:"#time_creatDate",
			format:"YYYY-MM-DD",
			isinitVal:true,
			isTime:false, //isClear:false,
			minDate:"1014-09-19 00:00:00"
		}) ;
		jeDate({
			dateCell:"#time_endDate",
			format:"YYYY-MM-DD",
			isinitVal:true,
			isTime:false, //isClear:false,
			minDate:"1014-09-19 00:00:00"
		}) ;
		jeDate({
			dateCell:"#title_updatetime",
			format:"YYYY-MM-DD",
			isinitVal:true,
			isTime:false, //isClear:false,
			minDate:"1014-09-19 00:00:00"
		}) ;
  	});
  </script>
</html>
