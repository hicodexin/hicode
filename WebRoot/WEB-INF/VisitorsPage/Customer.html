<!DOCTYPE html>
<html>
  <head>
    <title>Customer.html</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8">

<!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
<link type="text/css" rel="stylesheet"
	href="/hicode/syscss/teacher_page.css" />
<link type="text/css" rel="stylesheet"
	href="/hicode/syscss/for_date.css" />
<script type="text/javascript" src="/hicode/sysjs/jquery.min.js"></script>
<script type="text/javascript" src="/hicode/sysjs/forfunctions.js"></script>
<script type="text/javascript" src="/hicode/sysjs/jeDate.js"></script>
</head>

<body>
	<!-- 隐藏  -->
	<div id="hidd_mask"></div>
	<div id="dv_update">
		<div class="dv_title" id="dv_title">添加学生信息</div>
		<div class="dv_upmain">
			<ul class="up_ul">
				<li><b>序号 : </b> <input type="text" id="tea_list" value=""disabled="disabled" /></li>
				<li><b>学生姓名 : </b> <input type="text" id="userName" /></li>
				<li>
					<b>学生性别 : </b> 
					<label for="sex_b"> 
						<img src="/hicode/sysimg/face_boy.jpg" /> 
						<input type="radio" id="sex_b" name="t_sex" value="1" />
					</label> 
					<label for="sex_g"> 
						<img src="/hicode/sysimg/face_girl.jpg" />
						<input type="radio" id="sex_g" name="t_sex" value="0" />
					</label>
				</li>
				<li>
					<b>是否在职 : </b> 
					<label for="job_b"> 
						<img src="/hicode/sysimg/face_smile.jpg" /> 
						<input type="radio" id="job_b" name="if_Onthejob" value="1" />
					</label> 
					<label for="job_g"> 
						<img src="/hicode/sysimg/face_grieved.jpg" /> 
						<input type="radio" id="job_g" name="if_Onthejob" value="0" />
					</label>
				</li>
				<li><b>入职时间 : </b> 
				<input id="time_creatDate" type="text" disabled="disabled"></li>
				<li>
					<b>离职时间 : </b> 
					<input class="datainp" id="time_endDate" type="text" placeholder="请选择">
				</li>
				<li><b>当前职称 : </b> <select id="update_sel">
						<option>讲师助教</option>
						<option>初级讲师</option>
						<option>中级讲师</option>
						<option>高级讲师</option>
						<option>教学总监</option>
				</select></li>
				<li><b>晋级时间 : </b> <input class="datainp" id="title_updatetime"
					type="text" placeholder="请选择" readonly></li>
			</ul>
		</div>
		<div id="dv_upbottom">
			<button id="up_sub">提交</button>
			<button id="up_res">返回</button>
		</div>
	</div>

	<div class="dv_top"></div>
	<hr>
	<div class="dv_title">报名信息详情</div>
	<button id="bt_1">添加</button>
	<div id="dv_table">
		<table id="tea_tbl" cellspacing="0">
			<thead>
				<tr>
					<th>序号</th>
					<th>学生姓名</th>
					<th>课程</th>
					<th>课时</th>
					<th>老师</th>
					<th>开课时间</th>
					<th>联系电话</th>
					<th>是否结束</th>
					<th>续费</th>
					<th>退费</th>
					<th>备注</th>
					<th>操作</th>
					<th>标记</th>
				</tr>
			</thead>
			<tbody id="tbl_body">
			</tbody>
		</table>
	</div>
	<div id="dv_page">
		<button id="bt_first" mypage="1">首页</button>
		<div id="dv_but"></div>
		<button id="bt_end">尾页</button>
	</div>
</body>
<script type="text/javascript">
	$().ready(function() {
		
		var bd_hig = document.documentElement.clientHeight;
  		$("#hidd_mask").css("height",bd_hig+"px");
  		$("#dv_update").hide();
  		$("#hidd_mask").hide();
  		start_post();
  		
  		//第一页
 		$("#bt_first").click(function(){
 			change_page(this);
 			$("#dv_but button:eq(0)").css({"backgroundColor":"#336699","color":"#fff"});
 		});
 		
 		//最后一页
 		$("#bt_end").click(function(){
 			change_page(this);
 			$("#dv_but button:eq(-1)").css({"backgroundColor":"#336699","color":"#fff"});
 		});
 		
 		//点击添加按钮
 		$("#bt_1").click(function(){
 			$("#hidd_mask").hide().show(300);
 			$("#dv_update").hide().show(300);
 			var len = $("#tea_tbl tbody tr").length;   
			$("#tea_list").val(len+1);
			$("#userName").val("");
			$("#time_creatDate").val("");
			
			$.post("/hicode/teacher/showTeacher.spc",function(c){
				console.log(c);
				if(c.length > 0){
					for(var i=0;i<c.length;i++){
						var str = "<option value="+c[i].tid+">"+c[i].name+"</option>";
						$("#update_selteas").append(str);
					}
				}
			
			},"json");
			
			$.post("/hicode/adviser/showAdviser.spc",function(f){
				console.log(f);
				if(f.length > 0){
					for(var i=0;i<f.length;i++){
						var str = "<option value="+f[i].id+">"+f[i].name+"</option>";
						$("#update_seladvs").append(str);
					}
				}
			
			},"json");
			
 		});
 	
 		/* 添加学员信息，提交按钮  */
 		$("#up_sub").click(function(){
 			if($("#time_creatDate").val().length < 10){
 				$("#time_creatDate").css("borderColor","#f00");
 				return;
 			}else{
 				$("#time_creatDate").css("borderColor","#336699");
 			}
 			if($("#userName").val().trim().length<2){
 				$("#userName").css("borderColor","#f00");
 				return;
 			}else{
 				$("#userName").css("borderColor","#336699");
 			}
 			
 			var data = {
 						"time_creatDate":$("#time_creatDate").val(),
			 			"userName":$("#userName").val().trim(),
			 			"t_sex":$('input:radio[name="t_sex"]:checked').val(),
			 			"update_selclass":$("#update_selclass").val(),
			 			"update_selteas":$("#update_selteas").val(),
			 			"update_seladvs":$("#update_seladvs").val(),
			 			"remarks":$("#remarks").val()
 			};
 			
 		 	$.post("/hicode/auditions/do_insertAuditions.spc",data,function(e){
 				$("#hidd_mask").hide().hide(300);
 				$("#dv_update").show().hide(300);
 				if(e.list_advs == 'ok'){
 					alert("添加成功");
 					$("#tbl_body").children("tr").remove();
 					start_post();
 				}else{
 					alert("添加失败,请联系管理员。。。。");
 				}
 			
 			},"json");
 			
 		});
  		
		// 日历插件
		jeDate({
			dateCell : "#time_creatDate",
			format : "YYYY-MM-DD",
			isinitVal : true,
			isTime : false, //isClear:false,
			minDate : "1014-09-19 00:00:00"
		}) ;
		jeDate({
			dateCell : "#time_endDate",
			isinitVal : true,
			isTime : false, //isClear:false,
			minDate : "1014-09-19 00:00:00"
		}) ;
		jeDate({
			dateCell : "#title_updatetime",
			format : "YYYY-MM-DD",
			isinitVal : true,
			isTime : false, //isClear:false,
			minDate : "1014-09-19 00:00:00"
		}) ;
		// 点击返回消失
  		$("#up_res").click(function(){
  			$("#hidd_mask").hide().hide(300);
 			$("#dv_update").show().hide(300);
 		});
 		
 		/* back_all: 待便利的值 */
 		function creat_tb(back_all,p_dom){
 			for (var i = 0; i < back_all.length; i++) {
				var tr = document.createElement("tr");
				var str = "<td>" + (i + 1) + "</td>";
					str += "<td>"+back_all[i].name+"</td>";
					str += "<td>"+back_all[i].kemu+"</td>";
					
				if(back_all[i].period == 1){
					str += "<td> 季度 </td>";
				}else if(back_all[i].period == 2){
					str += "<td> 年度 </td>";
				}else if(back_all[i].period == 3){
					str += "<td> 两年 </td>";
				}
				
				str += "<td>"+back_all[i].tea_name+"</td>";
				
				var firsttime = timestampToTime_hms(back_all[i].firsttime.time);
				
				str += "<td>"+firsttime+"</td>";
				
				str += "<td>"+back_all[i].tel+"</td>";
				
				if(back_all[i].over == 1){
					str += "<td> <img src='/hicode/sysimg/face_smile.jpg' /> </td>";
				}else{
					str += "<td>  </td>";
				}
				
				if(back_all[i].xufei == 1){
					str += "<td> <img src='/hicode/sysimg/face_smile.jpg' /> </td>";
				}else{
					str += "<td>  </td>";
				}
				
				if(back_all[i].tuifei == 1){
					str += "<td> <img src='/hicode/sysimg/face_grieved.jpg' /> </td>";
					$(tr).css("color","#b0b0b0");
				}else{
					str += "<td>  </td>";
				}
				
				if(back_all[i].remarks){
					str += "<td>"+back_all[i].beizhu+"</td>";
				}else{
					str += "<td>   </td>";
				}
				
				var btid = back_all[i].id;
				str += "<td><button id = '"+btid+"' name='"+(i+1)+"'onclick=alert('权限不足，请联系管理员')>修改</button></td>";
				str += "<td><input type='checkbox' value='"+btid+"' /></td>";
				$(tr).append(str);
				$(p_dom).append(tr);

			} 
 		
 		}
 		
 		/*切换页面*/
 		function change_page(this_dom){
			$("#dv_but button").css({"backgroundColor":"#fff","color":"#336699"});
			$(this_dom).css({"backgroundColor":"#336699","color":"#fff"});
			
			$.post("/hicode/customer/showCustomerByInfo.spc",{"page":$(this_dom).attr("mypage")},function(a_s){
				$("#tbl_body").html(' ');
				var js_arry = eval('(' + a_s + ')');
				creat_tb(js_arry.list_advs,"#tbl_body");
			});
		}
 		
 		/* 初始化数据 */
 		function start_post(){
 			$.post("/hicode/customer/showCustomerByInfo.spc", { "page" : 1 }, function(a) {
				console.log(a.list_advs);
				if (a) {
					creat_tb(a.list_advs,"#tbl_body");
					/* 添加页码 */
					if(a.all_num){
						for(var k=0;k<a.all_num;k++){
							var btn = document.createElement("button");
							$(btn).html(k+1);
							$(btn).attr("mypage",(k+1));
							if(k==0){
								$(btn).css({"backgroundColor":"#336699","color":"#fff"});
							}
							$(btn).click(function(){
								change_page(this);
							});
							
							$("#dv_but").append(btn);
						}
						$("#bt_end").attr("mypage",a.all_num);
					}
				}
				var hei = $("#tea_tbl").css("height");
				hei = hei.substr(0,hei.length-2 );
	 			if(hei>650){
	 				$("#dv_table").css("height","800px");
	 			}
	 			
			}, "json");
 		
 		}
 		
	});
</script>
</html>
    